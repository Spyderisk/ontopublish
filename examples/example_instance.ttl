@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdfg: <http://www.w3.org/2004/03/trix/rdfg-1/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix send: <http://ontology.spyderisk.org/ns/endpoint#> .
@prefix score: <http://ontology.spyderisk.org/ns/core#> .
@prefix my: <http:/ontology.spyderisk.org/p/ex#> .

my:SSHBastion a score:Asset ;
    rdfs:label "SSH bastion host"@en .
my:CoreVPN a score:Asset ;
    rdfs:label "core VPN asset"@en .
my:CommunalLaptop a score:Asset ;
    rdfs:label "a shared laptop used as a test-bed"@en .
    
my:Laboratory a score:TargetSystem ;
    rdfs:label "scientific laboratory full of computer equipment"@en ;
    score:has_structure my:SSHBastion, my:CoreVPN, my:CommunalLaptop .
    
my:InAttackersWorkstationCollection a score:RoleAttribute ;
    rdf:value "In attacker's workstation collection" .
my:InEmployersWorkstationCollection a score:RoleAttribute ;
    rdf:value "In attacker's employer's workstation collection" .
my:SharingAccess a score:RoleAttribute ;
    rdf:value "Employee(s) share their access with third party" .

my:PrimaryThreatRole a score:OrganisationalEntity ;
    score:takes_attribute my:InAttackersWorkstationCollection ;
    score:restricted_to my:SSHBastion .

my:SecondaryThreatRole a score:OrganisationalEntity ;
    score:takes_attribute my:InEmployersWorkstationCollection ;
    score:restricted_to my:CoreVPN .

my:VagueThreatRole a score:OrganisationalEntity ;
    score:takes_attribute my:SharingAccess .

# Demonstrate how to instantiate different concepts
# The distinction between sub-class and instatiation is somewhat unclear.
# The former case is really necessary for elaborating on things which
# subsequent classes can inherit, whereas the latter works fairly well here
# instead.
my:AccessProvided a score:ThreatCause ;
    rdfs:description "General attacker given access to system cause. The idea is that being given access *at* different assets has differential meaning, depending on the asset. There is still a relation to generally being provided access, and indeed we can instantiate different types of access, e.g. non-malicious persons could be given access, and this cause can be elaborated on by RDF instances later."@en .

my:AttackerGivenAccessToWorkstation a my:AccessProvided, score:ThreatCause ;
    rdfs:label "attacker given access to a workstation"@en ;
    score:has_likelihood my:InitialCauseMostLikely .

my:ScriptDeployment a score:ThreatCause ;
    rdfs:description "General script deployment threat cause, by an attacker. The idea is that deployment of a script *at* different assets would have different likelihoods. They are different things, but they are related."@en .
    
my:ScriptDeployedAtFirewall a my:ScriptDeployment, score:ThreatCause ;
    rdfs:label "attacker deploys malicious script at firewall"@en ;
    score:has_likelihood my:InitialCauseLeastLikely .

my:FriendOfEmployees a score:ThreatCause ;
    rdfs:label "threat is caused by employees letting their friend in"@en ;
    rdfs:description "We don't necessarily need to elaborate on all concepts, as we do for the two instances above. This example is simply a threat cause, perhaps it stands on its own, and we don't know enough to say any more about whether there are other threat causes which are context (appearing with different likelihoods at different assets) dependent."@en ;
    score:has_likelihood my:InitialCauseMediumLikely .

my:InitialCauseLikelihoodScheme a skos:ConceptScheme .

my:InitialCauseMostLikely a skos:Concept ;
    skos:inScheme my:InitialCauseLikelihoodScheme .
my:InitialCauseMediumLikely a skos:Concept ;
    skos:inScheme my:InitialCauseLikelihoodScheme .
my:InitialCauseLeastLikely a skos:Concept ;
    skos:inScheme my:InitialCauseLikelihoodScheme .
    
my:NetworkTrafficFromWorkstation a score:Threat ;
    rdfs:label "intense network traffic from workstation"@en ;
    score:incorporates_role my:PrimaryThreatRole ;
    score:has_cause my:AttackerGivenACcessToWorkstation ;
    score:has_likelihood my:InitialCauseMostLikely .
    
my:ScriptOnFirewall a score:Threat ;
    rdfs:label "attacker's script running on firewall"@en ;
    rdfs:description "A script running at a high level on a firewall. Firewall rules applying to the rest of the network can be subverted. Further, the attacker resorts to this strategy after their previous access to the firewall over serial port becomes impossible (CCTV now watches it)."@en ;
    score:incorporates_role my:SecondaryThreatRole ;
    score:has_cause my:ScriptDeployedAtFirewall ;
    score:has_likelihood my:InitialCauseLeastLikely ;
    score:triggered_by my:RestrictAccess .
    
my:UnknownFriendOfEmployees a score:Threat ;
    rdfs:label "unknown friend of one or more employees"@en ;
    rdfs:description "this person sometimes finds their way into the lab"@en ;
    score:incorporates_role my:VagueThreatRole ;
    score:has_cause my:FriendOfEployees ;
    score:has_likelihood my:InitialCauseMediumLikely .

my:RestrictAccess a score:ControlStrategy ;
    rdfs:description "Management elects to closely monitor and restrict access, to ensure unknown parties do not find their way into the laboratory."@en ;
    score:has_control my:CCTVAcrossLab, my:CCTVAgainstFirewall ;
    score:has_likelihood my:InitialCauseMostLikely .
    
my:FinalResortStrategy a score:ControlStrategy ;
    rdfs:description "The systems in the laboratory become unusable. The employees panic and turn everything off."@en ;
    score:has_control my:TurnOffSSHBastion, my:TurnOffCoreVPN ;
    score:has_likelihood my:InitialCauseLeastLikely .
    
my:DeployCCTV a score:AssetControl ;
    rdfs:description "CCTV is deployed, looking at particular assets in the laboratory."@en .
my:CCTVAcrossLab a score:AssetControl, my:DeployCCTV ;
    rdfs:description "CCTV is deployed at strategic location. This is designed to watch usage of the communal laptop, which moves around the laboratory as different employees use it. Hence this asset control really concerns the laptop."@en ;
    score:has_likelihood my:InitialCauseMostLikely .
my:CCTVAgainstFirewall a score:AssetControl ;
    rdfs:description "CCCV focuses on the core VPN, especially serial ports which have poor access control."@en ;
    score:has_likelihood my:InitialCauseMostLikely .
    
my:TurnOffMachine a score:AssetControl .
my:TurnOffSSHBastion a score:AssetControl ;#my:TurnOffMachine, score:AssetControl ;
    score:has_likelihood my:InitialCauseLeastLikely .
my:TurnOffCoreVPN a score:AssetControl ;#my:TurnOffMachine, score:AssetControl ;
    score:has_likelihood my:InitialCauseMediumLikely .
    

#my:interface_flapping a score:BehaviourAttribute .
#my:high_CPU_load a score:BehaviourAttribute .
my:SSHBastionReachability a score:AssetTrustworthiness ;
    score:has_likelihood my:InitialCauseMostLikely .
    
my:PortsProtected a score:AssetTrustworthiness ;
    score:has_likelihood my:InitialCauseMostLikely .

# Defined like this for reusability, even though we may only use it once
#my:manifest_interface_flapping a score:undermines ;
#    rdfs:domain score:AssetBehaviour ;
#    rdfs:range  score:AssetTrustworthiness ;
#    score:via   my:interface_flapping .
#
#my:manifest_high_CPU_load a score:undermines ;
#    rdfs:domain score:AssetBehaviour ;
#    rdfs:range  score:AssetTrustworthiness ;
#    score:via   my:high_CPU_load .
    
my:NetworkInterfaceUnderLoad a score:AssetBehaviour ;
    #my:manifest_flapping_interface my:SSHBastionReachability .
    score:undermines my:SSHBastionReachability ;
    score:has_likelihood my:InitialCauseMostLikely .
    
my:NetworkInterfaceRaceCondition a score:AssetBehaviour ;
    #my:manifest_high_CPU_load my:PortsProtected .
    score:undermines my:PortsProtected ;
    score:has_likelihood my:InitialCauseLeastLikely .
        
my:SSHBastion
    score:has_property my:SSHBastionReachability ;
    score:has_property my:NetworkInterfaceUnderLoad .
    
my:CoreVPN
    score:has_property my:PortsProtected ;
    score:has_property my:NetworkInterfaceRaceCondition ;
    score:has_property my:CCTVAgainstFirewall .

my:CommunalLaptop
    score:has_property my:CCTVAcrossLab .
    
my:laptop_accessed_from a score:AssetRelation ;
    rdfs:domain my:CommunalLaptop ;
    rdfs:range  my:SSHBastion .
